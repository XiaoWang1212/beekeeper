(function(){"use strict";var e={9308:function(e,t,s){var a=s(3751),o=s(641);function i(e,t){const s=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(s)}var n=s(6262);const r={},l=(0,n.A)(r,[["render",i]]);var c=l,d=s(5220),m=s(33),h=s.p+"img/honeybee.e7e31192.png";const u={class:"login-container"},p={class:"login-card"},y={class:"form-group"},v={key:0,class:"message"},g=["disabled"],k={key:1,class:"continue-game"};function f(e,t,s,i,n,r){return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("div",p,[t[4]||(t[4]=(0,o.Lk)("h1",null,"養蜂達人",-1)),t[5]||(t[5]=(0,o.Lk)("div",{class:"game-description"},[(0,o.Lk)("p",null,"歡迎來到養蜂達人！開始你的養蜂生涯吧！")],-1)),t[6]||(t[6]=(0,o.Lk)("div",{class:"bee-animation"},[(0,o.Lk)("img",{src:h,alt:"蜜蜂",class:"bee-icon"})],-1)),(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>r.startGame&&r.startGame(...e)),["prevent"])),class:"login-form"},[(0,o.Lk)("div",y,[t[3]||(t[3]=(0,o.Lk)("label",{for:"characterName"},"你的養蜂人名稱",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"characterName","onUpdate:modelValue":t[0]||(t[0]=e=>n.characterName=e),placeholder:"請輸入你的名稱",maxlength:"12",required:""},null,512),[[a.Jo,n.characterName]])]),n.message?((0,o.uX)(),(0,o.CE)("div",v,(0,m.v_)(n.message),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",class:"start-button",disabled:!r.canStart}," 開始遊戲 ",8,g),n.hasSavedGame?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.continueGame&&r.continueGame(...e)),class:"continue-button"}," 繼續遊戲 ")])):(0,o.Q3)("",!0)],32),t[7]||(t[7]=(0,o.Lk)("div",{class:"game-features"},[(0,o.Lk)("h3",null,"遊戲特色"),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"🐝 建立你自己的蜂場"),(0,o.Lk)("li",null,"🌼 派遣蜜蜂採集各種花蜜"),(0,o.Lk)("li",null,"🏆 升級你的蜂巢，增加產量"),(0,o.Lk)("li",null,"⚡ 應對各種自然挑戰和病蟲害")])],-1))])])}s(4114);var b={name:"LoginView",data(){return{characterName:"",message:"",hasSavedGame:!1}},computed:{canStart(){return this.characterName.trim().length>=2}},mounted(){this.checkSavedGame(),this.$route.query.error&&(this.message=decodeURIComponent(this.$route.query.error),this.$router.replace({path:this.$route.path}))},methods:{startGame(){this.canStart&&(localStorage.setItem("beekeeper_name",this.characterName),localStorage.setItem("beekeeper_new_game","true"),this.$router.push("/game"))},continueGame(){localStorage.removeItem("beekeeper_new_game"),this.$router.push("/game")},checkSavedGame(){const e=localStorage.getItem("beekeeper_game");if(this.hasSavedGame=!!e,this.hasSavedGame){const e=localStorage.getItem("beekeeper_name");e&&(this.characterName=e)}}}};const E=(0,n.A)(b,[["render",f],["__scopeId","data-v-294539d2"]]);var M=E,L=s.p+"img/honeyTotal.35c15db3.png",C=s.p+"img/coin.b872a83c.png";const T={class:"game-container"},_={class:"weather-display"},A={id:"weather-icon"},S={id:"weather-status"},H={class:"resources-panel"},w={class:"resource"},N={class:"resource-info"},x={class:"resource"},O={class:"resource-info"},D={class:"resource"},R={class:"resource-info"},$={class:"hive-display"},P={class:"hive-container",ref:"hiveContainer"},I={class:"hive-stats"},F={class:"action-panel"},B=["disabled"],G=["disabled"],Y=["disabled"],V=["disabled"],W={key:0,class:"badge"},X={class:"challenges-panel"},U={class:"challenge-actions"},j=["onClick"],K={class:"education-panel"};function q(e,t,s,i,n,r){const l=(0,o.g2)("foraging-modal"),c=(0,o.g2)("labor-task-modal"),d=(0,o.g2)("honey-storage-modal");return(0,o.uX)(),(0,o.CE)("div",T,[(0,o.Lk)("header",null,[t[7]||(t[7]=(0,o.Lk)("h1",null,"養蜂達人",-1)),(0,o.Lk)("div",_,[(0,o.Lk)("span",A,(0,m.v_)(e.currentWeather.icon),1),(0,o.Lk)("span",S,(0,m.v_)(e.currentWeather.name),1)])]),(0,o.Lk)("div",H,[(0,o.Lk)("div",w,[t[9]||(t[9]=(0,o.Lk)("img",{src:h,alt:"蜜蜂",class:"resource-icon"},null,-1)),(0,o.Lk)("div",N,[t[8]||(t[8]=(0,o.Lk)("span",{class:"resource-name"},"蜜蜂",-1)),(0,o.Lk)("span",null,(0,m.v_)(e.bees),1)])]),(0,o.Lk)("div",x,[t[11]||(t[11]=(0,o.Lk)("img",{src:L,alt:"蜂蜜",class:"resource-icon"},null,-1)),(0,o.Lk)("div",O,[t[10]||(t[10]=(0,o.Lk)("span",{class:"resource-name"},"蜂蜜 (kg)",-1)),(0,o.Lk)("span",null,(0,m.v_)(e.honey.toFixed(1)),1)])]),(0,o.Lk)("div",D,[t[13]||(t[13]=(0,o.Lk)("img",{src:C,alt:"金錢",class:"resource-icon"},null,-1)),(0,o.Lk)("div",R,[t[12]||(t[12]=(0,o.Lk)("span",{class:"resource-name"},"金錢",-1)),(0,o.Lk)("span",null,(0,m.v_)(e.money),1)])])]),(0,o.Lk)("div",$,[t[18]||(t[18]=(0,o.Lk)("h2",null,"蜂巢狀況",-1)),(0,o.Lk)("div",P,null,512),(0,o.Lk)("div",I,[(0,o.Lk)("div",null,[t[14]||(t[14]=(0,o.eW)(" 健康度: ")),(0,o.Lk)("span",{style:(0,m.Tr)(e.healthColorStyle)},(0,m.v_)(e.hiveHealth)+"%",5)]),(0,o.Lk)("div",null,[t[15]||(t[15]=(0,o.eW)(" 等級: ")),(0,o.Lk)("span",null,(0,m.v_)(e.hiveLevel),1)]),(0,o.Lk)("div",null,[t[16]||(t[16]=(0,o.eW)(" 產蜜效率: ")),(0,o.Lk)("span",null,(0,m.v_)(e.honeyPerBeePerMinute.toFixed(2))+" kg/分鐘/蜂",1)]),(0,o.Lk)("div",null,[t[17]||(t[17]=(0,o.eW)(" 蜂箱容量: ")),(0,o.Lk)("span",null,(0,m.v_)(e.hiveCapacity)+" 隻",1)])])]),(0,o.Lk)("div",F,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.collectHoney&&e.collectHoney(...t)),disabled:!e.canCollectHoney,class:"game-button"}," 採集蜂蜜 ",8,B),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...t)=>e.buyBee&&e.buyBee(...t)),disabled:!e.canBuyBee,class:"game-button"}," 購買蜜蜂 (¥"+(0,m.v_)(e.beeCost)+") ",9,G),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...t)=>e.upgradeHive&&e.upgradeHive(...t)),disabled:!e.canUpgradeHive,class:"game-button"}," 升級蜂巢 (¥"+(0,m.v_)(e.hiveUpgradeCost)+") ",9,Y),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...t)=>e.checkHive&&e.checkHive(...t)),class:"game-button"},"檢查蜂巢"),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.openForagingModal&&r.openForagingModal(...e)),class:"game-button special"}," 採蜜任務 "),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>r.openHoneyStorage&&r.openHoneyStorage(...e)),class:"game-button honey-storage-button",disabled:r.disableButtons},[t[19]||(t[19]=(0,o.Lk)("span",{class:"icon"},"🍯",-1)),t[20]||(t[20]=(0,o.eW)(" 蜂蜜倉庫 ")),e.hasNewOrders?((0,o.uX)(),(0,o.CE)("span",W,"!")):(0,o.Q3)("",!0)],8,V)]),(0,o.Lk)("div",X,[t[21]||(t[21]=(0,o.Lk)("h2",null,"養蜂挑戰",-1)),e.currentChallenge?(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,m.C4)(["challenge-card",e.currentChallenge?.type])},[(0,o.Lk)("h3",null,(0,m.v_)(e.currentChallenge.data.title),1),(0,o.Lk)("p",null,(0,m.v_)(e.currentChallenge.data.description),1),(0,o.Lk)("div",U,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.currentChallenge.data.solutions,((t,s)=>((0,o.uX)(),(0,o.CE)("button",{key:s,onClick:s=>e.applySolution(t),class:"challenge-button"},(0,m.v_)(t.name),9,j)))),128))])],2)),[[a.aG,!e.challengeHidden]]):(0,o.Q3)("",!0)]),t[23]||(t[23]=(0,o.Lk)("div",{class:"notification-area"},null,-1)),(0,o.Lk)("div",K,[t[22]||(t[22]=(0,o.Lk)("h2",null,"今日養蜂知識",-1)),(0,o.Lk)("p",null,(0,m.v_)(e.currentBeeFact),1)]),(0,o.Lk)("div",{id:"modal-overlay",class:(0,m.C4)(["modal-overlay",{active:n.isModalActive,hidden:!n.isModalActive}]),onClick:t[6]||(t[6]=(...e)=>r.closeAllModals&&r.closeAllModals(...e))},null,2),(0,o.bF)(l,{"is-active":n.isForagingModalActive,onCloseModal:r.closeForagingModal,onStartMission:e.startForagingMission,onSellAllHoney:e.sellAllHoney,onUpdateSelectedArea:e.updateSelectedArea},null,8,["is-active","onCloseModal","onStartMission","onSellAllHoney","onUpdateSelectedArea"]),e.$store.state.laborTasks&&e.$store.state.laborTasks.currentTask?((0,o.uX)(),(0,o.Wv)(c,{key:0,task:e.$store.state.laborTasks,onComplete:e.completeLaborTask},null,8,["task","onComplete"])):(0,o.Q3)("",!0),(0,o.bF)(d,{"is-active":n.isHoneyStorageModalActive,onCloseModal:r.closeHoneyStorageModal},null,8,["is-active","onCloseModal"])])}var Q=s(6278);const J={class:"modal-header"},z={class:"modal-content"},Z={class:"modal-tabs"},ee=["onClick"],te={class:"tab-content"},se={class:"area-selection"},ae={class:"area-grid"},oe=["data-area","onClick"],ie={key:0,class:"area-stats"},ne={class:"area-stat"},re={class:"yield"},le={class:"area-stat"},ce={class:"area-stat"},de={class:"time"},me={key:1,class:"lock-icon"},he={class:"mission-setup"},ue={class:"mission-form"},pe={class:"form-group"},ye={class:"slider-container"},ve=["max"],ge={class:"form-group"},ke={class:"duration-buttons"},fe={class:"form-info"},be=["disabled"],Ee={class:"missions-container"},Me={key:0,class:"empty-missions"},Le={class:"mission-header"},Ce={class:"mission-title"},Te={class:"mission-area"},_e={class:"mission-timer"},Ae={class:"mission-details"},Se={class:"mission-progress"},He={class:"report-section"},we={class:"report-stats"},Ne={class:"stat-item"},xe={class:"stat-value"},Oe={class:"stat-item"},De={class:"stat-value"},Re={class:"stat-item"},$e={class:"stat-value"},Pe={class:"stat-item"},Ie={class:"stat-value"},Fe={class:"report-section"},Be={class:"honey-stats"},Ge={class:"honey-name"},Ye={class:"honey-amount"},Ve={class:"honey-value"},We={class:"total-honey"},Xe={class:"report-section"},Ue={class:"mission-history"},je={key:0,class:"empty-history"},Ke={class:"mission-record-header"},qe={class:"mission-area-name"},Qe={class:"mission-date"},Je={class:"mission-record-details"},ze={key:0,class:"mission-harvest"},Ze={class:"harvest-grid"},et={class:"honey-info"},tt={class:"honey-name"},st={key:1};function at(e,t,s,i,n,r){return(0,o.uX)(),(0,o.CE)("div",{class:(0,m.C4)(["modal",{active:s.isActive,hidden:!s.isActive}])},[(0,o.Lk)("div",J,[t[7]||(t[7]=(0,o.Lk)("h2",null,"採蜜任務中心",-1)),(0,o.Lk)("button",{class:"modal-close",onClick:t[0]||(t[0]=t=>e.$emit("close-modal"))},"×")]),(0,o.Lk)("div",z,[(0,o.Lk)("div",Z,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.tabs,((e,t)=>((0,o.uX)(),(0,o.CE)("button",{key:t,class:(0,m.C4)(["tab-button",{active:n.activeTab===e.id}]),onClick:t=>n.activeTab=e.id},(0,m.v_)(e.name),11,ee)))),128))]),(0,o.Lk)("div",te,[(0,o.Lk)("div",{class:(0,m.C4)(["tab-pane",{active:"areas-tab"===n.activeTab}])},[(0,o.Lk)("div",se,[t[11]||(t[11]=(0,o.Lk)("h3",null,"選擇採蜜區域",-1)),(0,o.Lk)("div",ae,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.areas,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,m.C4)(["area-card",{locked:e.locked,selected:n.selectedArea===e.id}]),"data-area":e.id,onClick:t=>r.selectArea(e)},[(0,o.Lk)("div",{class:(0,m.C4)(["area-image",e.id])},null,2),(0,o.Lk)("h4",null,(0,m.v_)(e.name),1),(0,o.Lk)("p",null,(0,m.v_)(e.description),1),e.locked?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",ie,[(0,o.Lk)("span",ne,[t[8]||(t[8]=(0,o.eW)("收益：")),(0,o.Lk)("span",re,(0,m.v_)(e.yield),1)]),(0,o.Lk)("span",le,[t[9]||(t[9]=(0,o.eW)("風險：")),(0,o.Lk)("span",{class:(0,m.C4)(["risk",e.riskLevel])},(0,m.v_)(e.risk),3)]),(0,o.Lk)("span",ce,[t[10]||(t[10]=(0,o.eW)("時間：")),(0,o.Lk)("span",de,(0,m.v_)(e.time),1)])])),e.locked?((0,o.uX)(),(0,o.CE)("div",me,"🔒")):(0,o.Q3)("",!0)],10,oe)))),128))])]),(0,o.Lk)("div",he,[t[17]||(t[17]=(0,o.Lk)("h3",null,"派遣採蜜隊伍",-1)),(0,o.Lk)("div",ue,[(0,o.Lk)("div",pe,[t[13]||(t[13]=(0,o.Lk)("label",{for:"bees-assigned"},"指派蜜蜂數量：",-1)),(0,o.Lk)("div",ye,[(0,o.bo)((0,o.Lk)("input",{type:"range",id:"bees-assigned",min:1,max:r.maxBeesAssignable,"onUpdate:modelValue":t[1]||(t[1]=e=>n.beesAssigned=e),class:"slider"},null,8,ve),[[a.Jo,n.beesAssigned,void 0,{number:!0}]]),(0,o.Lk)("span",null,(0,m.v_)(n.beesAssigned),1),t[12]||(t[12]=(0,o.eW)(" 隻 "))])]),(0,o.Lk)("div",ge,[t[14]||(t[14]=(0,o.Lk)("label",null,"採集時間：",-1)),(0,o.Lk)("div",ke,[(0,o.Lk)("button",{type:"button",class:(0,m.C4)(["duration-button",{active:"short"===n.missionDuration}]),onClick:t[2]||(t[2]=e=>n.missionDuration="short")}," 短程 ",2),(0,o.Lk)("button",{type:"button",class:(0,m.C4)(["duration-button",{active:"medium"===n.missionDuration}]),onClick:t[3]||(t[3]=e=>n.missionDuration="medium")}," 中程 ",2),(0,o.Lk)("button",{type:"button",class:(0,m.C4)(["duration-button",{active:"long"===n.missionDuration}]),onClick:t[4]||(t[4]=e=>n.missionDuration="long")}," 長程 ",2)])]),(0,o.Lk)("div",fe,[(0,o.Lk)("div",null,[t[15]||(t[15]=(0,o.eW)(" 預計收穫：")),(0,o.Lk)("span",null,(0,m.v_)(r.expectedYield),1)]),(0,o.Lk)("div",null,[t[16]||(t[16]=(0,o.eW)(" 風險評估：")),(0,o.Lk)("span",null,(0,m.v_)(r.missionRisk),1)])]),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>r.startMission&&r.startMission(...e)),class:"game-button mission-button",disabled:!r.canStartMission}," 開始採蜜任務 ",8,be)])])],2),(0,o.Lk)("div",{class:(0,m.C4)(["tab-pane",{active:"missions-tab"===n.activeTab}])},[t[18]||(t[18]=(0,o.Lk)("h3",null,"進行中的任務",-1)),(0,o.Lk)("div",Ee,[0===e.activeMissions.length?((0,o.uX)(),(0,o.CE)("div",Me," 目前沒有進行中的採蜜任務 ")):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.localMissions,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:e.id||t,class:"mission-card"},[(0,o.Lk)("div",Le,[(0,o.Lk)("div",null,[(0,o.Lk)("div",Ce,"採蜜任務 #"+(0,m.v_)(t+1),1),(0,o.Lk)("div",Te,(0,m.v_)(r.getAreaName(e.area)),1)]),(0,o.Lk)("div",_e,(0,m.v_)(r.formatTime(e.timeRemaining)),1)]),(0,o.Lk)("div",Ae,[(0,o.Lk)("div",null,"指派蜜蜂："+(0,m.v_)(e.bees)+" 隻",1),(0,o.Lk)("div",null,"風險等級："+(0,m.v_)(e.risk),1)]),(0,o.Lk)("div",Se,[(0,o.Lk)("div",{class:"progress-bar",style:(0,m.Tr)({width:e.progress+"%"})},null,4)])])))),128))])],2),(0,o.Lk)("div",{class:(0,m.C4)(["tab-pane",{active:"report-tab"===n.activeTab}])},[t[27]||(t[27]=(0,o.Lk)("h3",null,"採蜜任務報告",-1)),(0,o.Lk)("div",He,[t[23]||(t[23]=(0,o.Lk)("h4",null,"總體統計",-1)),(0,o.Lk)("div",we,[(0,o.Lk)("div",Ne,[t[19]||(t[19]=(0,o.Lk)("div",{class:"stat-label"},"總採蜜任務",-1)),(0,o.Lk)("div",xe,(0,m.v_)(n.missionStats.totalMissions),1)]),(0,o.Lk)("div",Oe,[t[20]||(t[20]=(0,o.Lk)("div",{class:"stat-label"},"成功任務",-1)),(0,o.Lk)("div",De,(0,m.v_)(n.missionStats.successMissions),1)]),(0,o.Lk)("div",Re,[t[21]||(t[21]=(0,o.Lk)("div",{class:"stat-label"},"失敗任務",-1)),(0,o.Lk)("div",$e,(0,m.v_)(n.missionStats.failedMissions),1)]),(0,o.Lk)("div",Pe,[t[22]||(t[22]=(0,o.Lk)("div",{class:"stat-label"},"成功率",-1)),(0,o.Lk)("div",Ie,(0,m.v_)(r.calculateSuccessRate())+"%",1)])])]),(0,o.Lk)("div",Fe,[t[24]||(t[24]=(0,o.Lk)("h4",null,"蜂蜜收穫統計",-1)),(0,o.Lk)("div",Be,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.honeyTypes,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"honey-stat"},[(0,o.Lk)("div",{class:"honey-icon",style:(0,m.Tr)({backgroundColor:r.getHoneyColor(e.id)})},null,4),(0,o.Lk)("div",Ge,(0,m.v_)(e.name),1),(0,o.Lk)("div",Ye,(0,m.v_)(r.getHoneyAmount(e.id))+" kg ",1),(0,o.Lk)("div",Ve," 價值: "+(0,m.v_)(r.calculateHoneyValue(e.id))+" 元 ",1)])))),128))]),(0,o.Lk)("div",We,[(0,o.Lk)("div",null,"總收穫量: "+(0,m.v_)(r.calculateTotalHoney())+" kg",1),(0,o.Lk)("div",null,"總價值: "+(0,m.v_)(r.calculateTotalValue())+" 元",1)])]),(0,o.Lk)("div",Xe,[t[26]||(t[26]=(0,o.Lk)("h4",null,"最近任務記錄",-1)),(0,o.Lk)("div",Ue,[0===n.missionHistory.length?((0,o.uX)(),(0,o.CE)("div",je," 尚無任務記錄 ")):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.missionHistory,((e,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"mission-record"},[(0,o.Lk)("div",Ke,[(0,o.Lk)("div",{class:(0,m.C4)(["status-indicator",e.success?"success":"failure"])},null,2),(0,o.Lk)("div",qe,(0,m.v_)(r.getAreaName(e.area)),1),(0,o.Lk)("div",Qe,(0,m.v_)(r.formatDate(e.date)),1)]),(0,o.Lk)("div",Je,[(0,o.Lk)("div",null,"蜜蜂數量: "+(0,m.v_)(e.bees)+" 隻",1),(0,o.Lk)("div",null,"風險等級: "+(0,m.v_)(e.risk),1),e.success?((0,o.uX)(),(0,o.CE)("div",ze,[t[25]||(t[25]=(0,o.Lk)("div",{class:"harvest-header"},"收穫:",-1)),(0,o.Lk)("div",Ze,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.formatHoneyGain(e.rewards),(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"harvest-item"},[(0,o.Lk)("div",{class:"honey-dot",style:(0,m.Tr)({backgroundColor:r.getHoneyColor(e.id)})},null,4),(0,o.Lk)("div",et,[(0,o.Lk)("span",tt,(0,m.v_)(e.name),1),(0,o.Lk)("span",{class:(0,m.C4)(["honey-amount",{zero:0===e.amount}])},(0,m.v_)(e.amount.toFixed(1))+" kg ",3)])])))),128))])])):((0,o.uX)(),(0,o.CE)("div",st," 損失: "+(0,m.v_)(e.lostBees>0?`${e.lostBees} 隻蜜蜂`:"無"),1))])])))),128))])]),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...t)=>e.sellAllHoney&&e.sellAllHoney(...t)),class:"game-button"}," 出售所有花蜜 ")],2)])])],2)}s(8111),s(116),s(7588),s(1701),s(8237);var ot={name:"ForagingModal",props:{isActive:{type:Boolean,default:!1}},data(){return{activeTab:"areas-tab",beesAssigned:1,missionDuration:"short",selectedArea:null,tabs:[{id:"areas-tab",name:"採蜜區域"},{id:"missions-tab",name:"進行中任務"},{id:"report-tab",name:"戰損報告"}],missionStats:{totalMissions:0,successMissions:0,failedMissions:0},missionHistory:[],honeyColors:{common:"#ffcc00",wildflower:"#ffa64d",mountain:"#996633",rare:"#e64d00"},areas:[{id:"meadow",name:"花草草地",description:"常見花蜜，安全性高",yield:"普通",risk:"低",riskLevel:"low",time:"短",locked:!1},{id:"forest",name:"深林山谷",description:"野花蜜源，品質較佳",yield:"良好",risk:"中",riskLevel:"medium",time:"中",locked:!1},{id:"mountain",name:"高山草原",description:"高海拔蜜源，稀有花種",yield:"優質",risk:"高",riskLevel:"high",time:"長",locked:!1},{id:"orchard",name:"果園花區",description:"需達到蜂巢3級解鎖",locked:!0,minLevel:3},{id:"rare",name:"稀有花園",description:"需達到蜂巢5級解鎖",locked:!0,minLevel:5}],honeyTypes:[{id:"common",name:"普通花蜜",price:10},{id:"wildflower",name:"野花蜜",price:15},{id:"mountain",name:"高山花蜜",price:25},{id:"rare",name:"稀有花蜜",price:50}],missionTimer:null,localMissions:[]}},computed:{...(0,Q.aH)({bees:e=>e.bees.bees,hiveLevel:e=>e.bees.hiveLevel,storeSelectedArea:e=>e.foraging.selectedArea,foragingAreas:e=>e.foraging.areas,activeMissions:e=>e.foraging.activeMissions,honeyCollected:e=>e.foraging.honeyCollected,storedMissionStats:e=>e.foraging.missionStats,storedMissionHistory:e=>e.foraging.missionHistory}),maxBeesAssignable(){return Math.min(5,this.bees)},expectedYield(){if(!this.selectedArea)return"請選擇區域";const e=this.areas.find((e=>e.id===this.selectedArea));let t="";switch(e.id){case"meadow":t=this.beesAssigned<=2?"少量普通花蜜":"中量普通花蜜";break;case"forest":t=this.beesAssigned<=2?"少量野花蜜":"中量野花蜜";break;case"mountain":t=this.beesAssigned<=2?"少量高山花蜜":"中量高山花蜜";break;default:t="少量普通花蜜"}return"medium"===this.missionDuration?t=t.replace("少量","中量").replace("中量","大量"):"long"===this.missionDuration&&(t=t.replace("少量","大量").replace("中量","豐富")),t},missionRisk(){if(!this.selectedArea)return"未知";const e=this.areas.find((e=>e.id===this.selectedArea));let t="";switch(e.riskLevel){case"low":t=this.beesAssigned<=2?"極低":"低";break;case"medium":t=this.beesAssigned<=2?"低":"中";break;case"high":t=this.beesAssigned<=2?"中":"高";break;default:t="未知"}return"medium"===this.missionDuration?"極低"===t?t="低":"低"===t?t="中":"中"===t&&(t="高"):"long"===this.missionDuration&&("極低"===t?t="中":"低"===t?t="高":"中"===t&&(t="極高")),t},canStartMission(){return this.selectedArea&&this.beesAssigned>0&&this.beesAssigned<=this.bees}},watch:{storeSelectedArea(e){this.selectedArea=e},storedMissionStats:{handler(e){this.missionStats={...e}},deep:!0,immediate:!0},storedMissionHistory:{handler(e){this.missionHistory=[...e]},deep:!0,immediate:!0},activeMissions:{handler(e){console.log("活動任務更新:",e.length),this.updateLocalMissions(e)},deep:!0,immediate:!0}},mounted(){this.checkAndUnlockAreas(),this.selectedArea=this.storeSelectedArea,this.startMissionTimer()},updated(){"missions-tab"===this.activeTab&&this.activeMissions.length>0&&!this.missionTimer&&this.startMissionTimer()},beforeUnmount(){this.clearMissionTimer()},methods:{...(0,Q.i0)({updateSelectedArea:"foraging/selectArea",startForagingMission:"foraging/startForagingMission",sellAllHoney:"honey/sellAllHoney"}),selectArea(e){e.locked||(this.selectedArea=e.id,this.updateSelectedArea(e.id))},startMission(){if(!this.canStartMission)return;const e=this.foragingAreas[this.selectedArea];e&&console.log(`該區域基礎時間: ${e.baseDuration}秒`);const t={area:this.selectedArea,bees:parseInt(this.beesAssigned),duration:this.missionDuration,risk:this.missionRisk};this.startForagingMission(t),this.beesAssigned=1,this.missionDuration="short",this.activeTab="missions-tab",this.$nextTick((()=>{const e=document.querySelector(".modal-content");e&&e.scrollTo({top:0,behavior:"smooth"})}))},checkAndUnlockAreas(){this.areas.forEach((e=>{e.minLevel&&this.hiveLevel>=e.minLevel&&(e.locked=!1)}))},getAreaName(e){const t=this.areas.find((t=>t.id===e));return t?t.name:"未知區域"},formatTime(e){if(!e&&0!==e)return"--:--";const t=Math.floor(e/60),s=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},getHoneyAmount(e){return this.honeyCollected&&void 0!==this.honeyCollected[e]?this.honeyCollected[e].toFixed(1):"0.0"},calculateSuccessRate(){if(0===this.missionStats.totalMissions)return"0.0";const e=this.missionStats.successMissions/this.missionStats.totalMissions*100;return e.toFixed(1)},getHoneyColor(e){return this.honeyColors[e]||"#ffcc00"},calculateHoneyValue(e){const t=this.honeyTypes.find((t=>t.id===e)),s=this.getHoneyAmount(e);return(t.price*parseFloat(s)).toFixed(0)},calculateTotalHoney(){if(!this.honeyCollected)return"0.0";const e=Object.values(this.honeyCollected).reduce(((e,t)=>e+(t||0)),0);return e.toFixed(1)},calculateTotalValue(){if(!this.honeyCollected)return"0";let e=0;return this.honeyTypes.forEach((t=>{const s=this.honeyCollected[t.id]||0;e+=s*t.price})),e.toFixed(0)},formatDate(e){const t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${t.getMinutes().toString().padStart(2,"0")}`},formatHoneyGain(e){if(!e)return"無收穫";const t=this.honeyTypes.map((e=>e.id));return t.map((t=>{const s=this.honeyTypes.find((e=>e.id===t)),a=e[t]||0;return{id:t,name:s?s.name:t,amount:a}}))},updateLocalMissions(e){this.localMissions=e.map((e=>{const t=Date.now(),s=Math.max(0,e.endTime-t),a=e.endTime-e.startTime,o=t-e.startTime,i=Math.min(100,Math.max(0,o/a*100));return{...e,timeRemaining:Math.floor(s/1e3),progress:i.toFixed(1)}}))},startMissionTimer(){this.clearMissionTimer(),this.missionTimer=setInterval((()=>{this.activeMissions.length>0?this.updateLocalMissions(this.activeMissions):this.clearMissionTimer()}),1e3)},clearMissionTimer(){this.missionTimer&&(clearInterval(this.missionTimer),this.missionTimer=null)}}};const it=(0,n.A)(ot,[["render",at],["__scopeId","data-v-5e0b06ea"]]);var nt=it;const rt={key:0,class:"labor-overlay"},lt={class:"labor-container"},ct={class:"labor-title"},dt={class:"progress-container"},mt=["disabled"],ht={class:"button-text"};function ut(e,t,s,a,i,n){return s.task&&s.task.currentTask?((0,o.uX)(),(0,o.CE)("div",rt,[(0,o.Lk)("div",lt,[(0,o.Lk)("h3",ct,(0,m.v_)(s.task.taskName),1),(0,o.Lk)("div",dt,[(0,o.Lk)("div",{class:"progress-bar",style:(0,m.Tr)({width:n.progress+"%"})},null,4)]),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.performWork&&n.performWork(...e)),class:(0,m.C4)(["game-button",{completed:i.isCompleted}]),disabled:i.isCompleted},[(0,o.Lk)("span",ht,(0,m.v_)(n.buttonText),1)],10,mt)])])):(0,o.Q3)("",!0)}var pt={name:"LaborTaskModal",props:{task:{type:Object,required:!0}},data(){return{isCompleted:!1,localClicksDone:0}},computed:{progress(){const e=this.localClicksDone+(this.task.clicksCompleted||0);return e/this.task.clicksNeeded*100},buttonText(){if(this.isCompleted)return"完成！";{const e=this.task.clicksNeeded-((this.task.clicksCompleted||0)+this.localClicksDone);return`努力工作 (還需 ${e} 次)`}}},watch:{task:{handler(){this.isCompleted=!1,this.localClicksDone=0},deep:!0}},methods:{...(0,Q.i0)({completeLaborTask:"laborTasks/progressTask"}),performWork(){this.isCompleted||(this.localClicksDone++,this.localClicksDone+this.task.clicksCompleted<this.task.clicksNeeded?this.completeLaborTask():(this.isCompleted=!0,setTimeout((()=>{this.$emit("complete",this.localClicksDone)}),500)))}}};const yt=(0,n.A)(pt,[["render",ut],["__scopeId","data-v-8b48be4a"]]);var vt=yt;const gt={class:"modal-header"},kt={class:"modal-content"},ft={class:"storage-info"},bt={class:"capacity-bar"},Et={class:"capacity-text"},Mt=["disabled"],Lt={class:"honey-list"},Ct={class:"honey-info"},Tt={class:"honey-details"},_t={class:"honey-amount"},At={class:"honey-actions"},St={class:"sell-controls"},Ht=["max","onUpdate:modelValue","disabled"],wt=["onClick","disabled"],Nt={class:"orders-list"},xt={key:0,class:"no-orders"},Ot={class:"order-header"},Dt={class:"order-expiry"},Rt={class:"order-requirements"},$t={class:"requirement-amount"},Pt={class:"order-value"},It={class:"base-value"},Ft={class:"bonus-value"},Bt={class:"total-value"},Gt=["onClick","disabled"];function Yt(e,t,s,i,n,r){return(0,o.uX)(),(0,o.CE)("div",{class:(0,m.C4)(["modal",{active:s.isActive,hidden:!s.isActive}])},[(0,o.Lk)("div",gt,[t[2]||(t[2]=(0,o.Lk)("h2",null,"蜂蜜倉庫",-1)),(0,o.Lk)("button",{class:"modal-close",onClick:t[0]||(t[0]=(...e)=>r.closeModal&&r.closeModal(...e))},"×")]),(0,o.Lk)("div",kt,[(0,o.Lk)("div",ft,[(0,o.Lk)("div",bt,[(0,o.Lk)("div",{class:"capacity-fill",style:(0,m.Tr)({width:r.capacityPercentage+"%"})},null,4)]),(0,o.Lk)("div",Et,(0,m.v_)(r.totalHoney.toFixed(1))+"kg / "+(0,m.v_)(e.honeyCapacity)+"kg ",1),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.upgradeStorage&&r.upgradeStorage(...e)),class:"upgrade-button",disabled:!r.canUpgradeStorage}," 擴充倉庫 (¥"+(0,m.v_)(r.upgradeCost)+") ",9,Mt)]),t[3]||(t[3]=(0,o.Lk)("h3",null,"蜂蜜庫存",-1)),(0,o.Lk)("div",Lt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.inventory,((t,s)=>(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{key:s,class:"honey-item"},[(0,o.Lk)("div",Ct,[(0,o.Lk)("div",{class:"honey-color",style:(0,m.Tr)({backgroundColor:r.honeyTypeColor(s)})},null,4),(0,o.Lk)("div",Tt,[(0,o.Lk)("h3",null,(0,m.v_)(r.honeyTypeName(s)),1),(0,o.Lk)("p",null,(0,m.v_)(r.honeyTypeDescription(s)),1),(0,o.Lk)("div",_t,(0,m.v_)(t.toFixed(1))+"kg",1)])]),(0,o.Lk)("div",At,[(0,o.Lk)("div",St,[(0,o.bo)((0,o.Lk)("input",{type:"number",min:"0.1",max:t,step:"0.1","onUpdate:modelValue":e=>n.sellAmounts[s]=e,disabled:t<=0},null,8,Ht),[[a.Jo,n.sellAmounts[s],void 0,{number:!0}]]),(0,o.Lk)("button",{onClick:e=>r.sellHoney(s),disabled:!r.canSell(s),class:"sell-button"}," 出售 (¥"+(0,m.v_)(r.calculateSellValue(s))+") ",9,wt)])])])),[[a.aG,t>0||e.allHoneyTypes[s]]]))),128))]),t[4]||(t[4]=(0,o.Lk)("h3",null,"客戶訂單",-1)),(0,o.Lk)("div",Nt,[0===e.activeOrders.length?((0,o.uX)(),(0,o.CE)("div",xt," 目前沒有訂單，請等待客戶下單。 ")):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.activeOrders,((t,s)=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"order-item"},[(0,o.Lk)("div",Ot,[(0,o.Lk)("h3",null,(0,m.v_)(t.customer)+"的訂單",1),(0,o.Lk)("div",Dt," 剩餘時間: "+(0,m.v_)(r.formatRemainingTime(t.expiryTime)),1)]),(0,o.Lk)("div",Rt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.requirements,((t,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"requirement-item"},[(0,o.Lk)("div",{class:"honey-color",style:(0,m.Tr)({backgroundColor:r.honeyTypeColor(t.type)})},null,4),(0,o.Lk)("span",null,(0,m.v_)(r.honeyTypeName(t.type)),1),(0,o.Lk)("span",$t,(0,m.v_)(t.amount)+"kg / "+(0,m.v_)(Math.min(t.amount,e.inventory[t.type]).toFixed(1))+"kg ",1)])))),128))]),(0,o.Lk)("div",Pt,[(0,o.Lk)("div",It,"基本價值: ¥"+(0,m.v_)(t.baseValue),1),(0,o.Lk)("div",Ft,"獎勵: ¥"+(0,m.v_)(t.bonusValue),1),(0,o.Lk)("div",Bt,"總價: ¥"+(0,m.v_)(t.totalValue),1)]),(0,o.Lk)("button",{onClick:e=>r.fulfillOrder(s),disabled:!r.canFulfillOrder(t),class:"fulfill-button"}," 完成訂單 ",8,Gt)])))),128))])])],2)}var Vt={props:{isActive:{type:Boolean,default:!1}},data(){return{sellAmounts:{common:1,wildflower:1,mountain:1,rare:1}}},computed:{...(0,Q.aH)({inventory:e=>e.honey.inventory,honeyCapacity:e=>e.honey.capacity,activeOrders:e=>e.orders.active,allHoneyTypes:e=>e.honey.honeyTypes,money:e=>e.money}),totalHoney(){return Object.values(this.inventory).reduce(((e,t)=>e+t),0)},capacityPercentage(){return this.totalHoney/this.honeyCapacity*100},upgradeCost(){return Math.floor(1.2*this.honeyCapacity)},canUpgradeStorage(){return this.money>=this.upgradeCost}},methods:{closeModal(){this.$emit("close-modal")},honeyTypeName(e){return this.allHoneyTypes[e]?.name||e},honeyTypeDescription(e){return this.allHoneyTypes[e]?.description||""},honeyTypeColor(e){return this.allHoneyTypes[e]?.color||"#cccccc"},calculateSellValue(e){const t=this.sellAmounts[e]||0,s=.9*this.allHoneyTypes[e]?.basePrice||0;return Math.floor(t*s)},canSell(e){const t=this.sellAmounts[e]||0;return t>0&&t<=this.inventory[e]},sellHoney(e){this.canSell(e)&&this.$store.dispatch("honey/sellHoneyByType",{type:e,amount:this.sellAmounts[e]})},upgradeStorage(){this.$store.dispatch("honey/upgradeHoneyStorage")},canFulfillOrder(e){for(const t of e.requirements)if(this.inventory[t.type]<t.amount)return!1;return!0},fulfillOrder(e){this.$store.dispatch("orders/fulfillOrder",e)},formatRemainingTime(e){const t=Date.now(),s=e-t;if(s<=0)return"已過期";const a=Math.floor(s/36e5),o=Math.floor(s%36e5/6e4);return`${a}小時${o}分鐘`}}};const Wt=(0,n.A)(Vt,[["render",Yt],["__scopeId","data-v-6435ef66"]]);var Xt=Wt,Ut={name:"GameView",components:{ForagingModal:nt,LaborTaskModal:vt,HoneyStorageModal:Xt},data(){return{isModalActive:!1,isForagingModalActive:!1,isHoneyStorageModalActive:!1}},computed:{...(0,Q.aH)({bees:e=>e.bees.bees,honey:e=>e.honey.total||0,money:e=>e.money,hiveLevel:e=>e.bees.hiveLevel,hiveHealth:e=>e.bees.hiveHealth,hiveCapacity:e=>e.bees.hiveCapacity,honeyPerBeePerMinute:e=>e.bees.honeyPerBeePerMinute,beeCost:e=>e.bees.costs.bee,hiveUpgradeCost:e=>e.bees.costs.hiveUpgrade,currentChallenge:e=>e.challenges.currentChallenge,challengeHidden:e=>e.challenges.challengeHidden,currentBeeFact:e=>e.currentBeeFact,laborTask:e=>e.laborTasks,weatherTypes:e=>e.weather.weatherTypes}),...(0,Q.L8)({healthColorStyle:"bees/healthColorStyle",canBuyBee:"bees/canBuyBee",canUpgradeHive:"bees/canUpgradeHive",canCollectHoney:"honey/canCollectHoney",hasNewOrders:"orders/hasNewOrders",currentWeather:"weather/currentWeather"}),disableButtons(){return this.$store.state.laborTasks&&null!==this.$store.state.laborTasks.currentTask}},mounted(){this.initGame(),this.$nextTick((()=>{this.renderBees()})),this.$watch((()=>this.$store.state.bees.bees),(()=>{this.renderBees()}))},methods:{...(0,Q.i0)({initGame:"initGame",collectHoney:"honey/collectHoney",buyBee:"bees/buyBee",upgradeHive:"bees/upgradeHive",checkHive:"bees/checkHive",applySolution:"challenges/applySolution",startForagingMission:"foraging/startForagingMission",sellAllHoney:"honey/sellAllHoney",updateSelectedArea:"foraging/selectArea",completeLaborTask:"laborTasks/progressTask"}),openForagingModal(){this.isModalActive=!0,this.isForagingModalActive=!0},closeForagingModal(){this.isForagingModalActive=!1,this.isModalActive=!1},closeAllModals(e){"modal-overlay"===e.target.id&&(this.isForagingModalActive=!1,this.isModalActive=!1,this.isHoneyStorageModalActive=!1)},renderBees(){const e=this.$refs.hiveContainer;if(!e)return;while(e.firstChild)e.removeChild(e.firstChild);const t=e.clientWidth,s=e.clientHeight,a=30;for(let o=0;o<this.bees;o++){const o=document.createElement("div");o.className="bee";let i=60*Math.random()+20,n=60*Math.random()+20;o.style.left=`${i}%`,o.style.top=`${n}%`,o.style.animationDelay=5*Math.random()+"s";const r=i/100*t,l=n/100*s,c=r,d=t-r,m=l,h=s-l,u=Math.min(c,d,m,h)-a,p=Math.min(Math.max(.7*u,5),15);o.style.setProperty("--x0",Math.random()*p-p/2+"px"),o.style.setProperty("--y0",Math.random()*p-p/2+"px"),o.style.setProperty("--r0",20*Math.random()-10+"deg"),o.style.setProperty("--x25",Math.random()*p-p/2+"px"),o.style.setProperty("--y25",Math.random()*p-p/2+"px"),o.style.setProperty("--r25",20*Math.random()-10+"deg"),o.style.setProperty("--x50",Math.random()*p-p/2+"px"),o.style.setProperty("--y50",Math.random()*p-p/2+"px"),o.style.setProperty("--r50",20*Math.random()-10+"deg"),o.style.setProperty("--x75",Math.random()*p-p/2+"px"),o.style.setProperty("--y75",Math.random()*p-p/2+"px"),o.style.setProperty("--r75",20*Math.random()-10+"deg"),o.style.setProperty("--x100",Math.random()*p-p/2+"px"),o.style.setProperty("--y100",Math.random()*p-p/2+"px"),o.style.setProperty("--r100",20*Math.random()-10+"deg");const y=Math.sqrt(Math.pow((i-50)/50,2)+Math.pow((n-50)/50,2)),v=3+4*(1-y);o.style.animationDuration=`${v}s`,e.appendChild(o)}},openHoneyStorage(){this.isHoneyStorageModalActive=!0,this.isModalActive=!0},closeHoneyStorageModal(){this.isHoneyStorageModalActive=!1,this.isModalActive=!1}}};const jt=(0,n.A)(Ut,[["render",q]]);var Kt=jt;const qt=[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:M},{path:"/game",name:"game",component:Kt}],Qt=(0,d.aE)({history:(0,d.LA)("/beekeeper/"),routes:qt});var Jt=Qt,zt={namespaced:!0,state:{bees:0,hiveLevel:1,hiveHealth:100,hiveCapacity:10,honeyPerBeePerMinute:.1,costs:{bee:50,hiveUpgrade:200}},getters:{healthColorStyle(e){return e.hiveHealth<30?{color:"#e53935"}:e.hiveHealth<60?{color:"#ff9800"}:{color:"#4caf50"}},canBuyBee(e,t,s){return s.money>=e.costs.bee&&e.bees<e.hiveCapacity},canUpgradeHive(e,t,s){return s.money>=e.costs.hiveUpgrade}},mutations:{SET_BEES(e,t){e.bees=t},ADD_BEES(e,t){e.bees+=t},REMOVE_BEES(e,t){e.bees=Math.max(0,e.bees-t)},SET_HIVE_LEVEL(e,t){e.hiveLevel=t},SET_HIVE_CAPACITY(e,t){e.hiveCapacity=t},SET_HONEY_EFFICIENCY(e,t){e.honeyPerBeePerMinute=t},SET_COSTS(e,t){e.costs=t},SET_HIVE_HEALTH(e,t){e.hiveHealth=Math.min(100,Math.max(0,t))},UPGRADE_HIVE(e){e.hiveLevel+=1,e.hiveCapacity+=5,e.honeyPerBeePerMinute+=.05,e.costs.hiveUpgrade=Math.floor(1.5*e.costs.hiveUpgrade)}},actions:{buyBee({state:e,commit:t,rootGetters:s,dispatch:a}){s["bees/canBuyBee"]&&(t("REMOVE_MONEY",e.costs.bee,{root:!0}),t("ADD_BEES",1),a("showNotification",{message:"購買了1隻新蜜蜂！",type:"success"},{root:!0}))},upgradeHive({state:e,commit:t,rootGetters:s,dispatch:a}){s["bees/canUpgradeHive"]&&(t("REMOVE_MONEY",e.costs.hiveUpgrade,{root:!0}),t("UPGRADE_HIVE"),a("showNotification",{message:`蜂巢升級到等級 ${e.hiveLevel}！容量和效率提升了`,type:"success"},{root:!0}))},checkHive({state:e,commit:t,dispatch:s}){s("laborTasks/startLaborTask",{taskName:"檢查蜂巢",clicksNeeded:8,onComplete:()=>{t("SET_HIVE_HEALTH",e.hiveHealth+5),s("showNotification",{message:"檢查完成，蜂巢狀況良好！",type:"success"},{root:!0})}},{root:!0})}}},Zt={namespaced:!0,state:{total:0,inventory:{common:0,wildflower:0,mountain:0,rare:0},capacity:100,honeyTypes:{common:{name:"普通蜂蜜",basePrice:10,color:"#ffcc00",description:"最常見的蜂蜜，微甜且口感溫和。"},wildflower:{name:"野花蜂蜜",basePrice:15,color:"#ffa64d",description:"採自各種野花，口感豐富，帶有花香。"},mountain:{name:"山地蜂蜜",basePrice:25,color:"#996633",description:"來自高山植物，味道濃郁，營養價值高。"},rare:{name:"稀有蜂蜜",basePrice:50,color:"#e64d00",description:"極為罕見的特殊蜂蜜，具有獨特的風味和藥用價值。"}}},getters:{canCollectHoney(e){return e.total>0},totalHoney(e){return Object.values(e.inventory).reduce(((e,t)=>e+t),0)},capacityPercentage(e,t){return t.totalHoney/e.capacity*100},upgradeCost(e){return Math.floor(1.2*e.capacity)}},mutations:{ADD_HONEY_BY_TYPE(e,{type:t,amount:s}){const a=Object.values(e.inventory).reduce(((e,t)=>e+t),0),o=e.capacity-a,i=Math.min(s,o);i<=0||(e.inventory[t]+=i,e.total+=i)},REMOVE_HONEY_BY_TYPE(e,{type:t,amount:s}){const a=Math.min(s,e.inventory[t]);return e.inventory[t]-=a,e.total-=a,a},SET_HONEY_CAPACITY(e,t){e.capacity=t},ADD_HONEY(e,t){const s={common:.7,wildflower:.2,mountain:.08,rare:.02},a=Math.random();let o="common",i=0;for(const[n,r]of Object.entries(s))if(i+=r,a<i){o=n;break}e.inventory[o]+=t,e.total+=t},SET_HONEY(e,t){for(const s in e.inventory)e.inventory[s]=0;e.inventory.common=t,e.total=t}},actions:{produceHoney({rootState:e,commit:t}){const s=e.bees.bees,a=e.bees.honeyPerBeePerMinute,o=e.weather.effectMultiplier||1,i=s*a*o/60;i>0&&t("ADD_HONEY",i)},upgradeHoneyStorage({state:e,getters:t,rootState:s,commit:a,dispatch:o}){const i=t.upgradeCost;if(s.money<i)return void o("showNotification",{message:`金錢不足！擴充倉庫需要${i}元`,type:"warning"},{root:!0});a("REMOVE_MONEY",i,{root:!0});const n=e.capacity+50;a("SET_HONEY_CAPACITY",n),o("showNotification",{message:`倉庫已擴充！新容量: ${n}kg`,type:"success"},{root:!0})},sellHoneyByType({state:e,commit:t,dispatch:s},{type:a,amount:o}){if(e.inventory[a]<o)return void s("showNotification",{message:`${e.honeyTypes[a].name}庫存不足！`,type:"warning"},{root:!0});const i=.9*e.honeyTypes[a].basePrice,n=Math.floor(o*i);t("REMOVE_HONEY_BY_TYPE",{type:a,amount:o}),t("ADD_MONEY",n,{root:!0}),s("showNotification",{message:`已出售${o}kg ${e.honeyTypes[a].name}，獲得${n}元`,type:"success"},{root:!0})},collectHoney({state:e,commit:t,dispatch:s}){e.total<=0?s("showNotification",{message:"沒有可收集的蜂蜜！",type:"info"},{root:!0}):s("laborTasks/startLaborTask",{taskName:"採集蜂蜜",clicksNeeded:5,onComplete:()=>{const a=Math.round(10*e.total);t("ADD_MONEY",a,{root:!0}),s("showNotification",{message:`成功收穫了 ${e.total.toFixed(1)}kg 蜂蜜，賣出獲得 ${a} 元！`,type:"success"},{root:!0}),t("SET_HONEY",0)}},{root:!0})}}},es={namespaced:!0,state:{active:[],completed:0,maxActive:3},getters:{hasNewOrders(e){return e.active.length>0}},mutations:{ADD_ORDER(e,t){e.active.length<e.maxActive&&e.active.push(t)},REMOVE_ORDER(e,t){e.active.splice(t,1)},COMPLETE_ORDER(e){e.completed++},SET_ORDERS(e,t){e.active=t.active||[],e.completed=t.completed||0,e.maxActive=t.maxActive||3}},actions:{initOrders({dispatch:e}){setInterval((()=>{e("generateOrder"),e("checkExpiredOrders")}),18e5);const t=Math.floor(2*Math.random())+1;for(let s=0;s<t;s++)e("generateOrder")},checkExpiredOrders({state:e,commit:t,dispatch:s}){const a=Date.now(),o=[];e.active.forEach(((e,t)=>{e.expiryTime<a&&o.push(t)}));for(let i=o.length-1;i>=0;i--){const a=o[i],n=e.active[a];s("showNotification",{message:`${n.customer}的訂單已過期！`,type:"warning"},{root:!0}),t("REMOVE_ORDER",a)}},generateOrder({state:e,commit:t,dispatch:s,rootState:a}){if(e.active.length>=e.maxActive)return;const o=Object.keys(a.honey.honeyTypes),i=[],n=Math.floor(3*Math.random())+1;for(let v=0;v<n;v++){let e,t;do{e=o[Math.floor(Math.random()*o.length)]}while(i.some((t=>t.type===e)));switch(e){case"common":t=Math.floor(5*Math.random())+3;break;case"wildflower":t=Math.floor(4*Math.random())+2;break;case"mountain":t=Math.floor(3*Math.random())+1;break;case"rare":t=Math.random()<.7?1:2;break;default:t=1}i.push({type:e,amount:t})}let r=0;for(const v of i)r+=v.amount*a.honey.honeyTypes[v.type].basePrice;const l=Math.floor(21*Math.random())+10,c=Math.floor(r*l/100),d=r+c,m=["王大廚","張麵包師","甜點工坊","健康食品店","李醫師","有機商店","山田農場","日式料理店","五星飯店","陳奶奶","李爺爺","美食博主"],h=m[Math.floor(Math.random()*m.length)],u=Math.floor(25*Math.random())+12,p=Date.now()+60*u*60*1e3,y={id:Date.now(),customer:h,requirements:i,baseValue:r,bonusValue:c,totalValue:d,expiryTime:p,createdAt:Date.now()};t("ADD_ORDER",y),s("showNotification",{message:`收到來自${h}的新訂單！`,type:"info"},{root:!0})},fulfillOrder({state:e,commit:t,dispatch:s,rootState:a},o){const i=e.active[o];if(!i)return;let n=!0;for(const r of i.requirements)if(a.honey.inventory[r.type]<r.amount){n=!1;break}if(n){for(const e of i.requirements)t("honey/REMOVE_HONEY_BY_TYPE",{type:e.type,amount:e.amount},{root:!0});if(t("ADD_MONEY",i.totalValue,{root:!0}),t("COMPLETE_ORDER"),t("REMOVE_ORDER",o),s("showNotification",{message:`成功完成${i.customer}的訂單！獲得${i.totalValue}元（含${i.bonusValue}元獎勵）`,type:"success"},{root:!0}),Math.random()<.2){const e=[{type:"money",amount:Math.floor(100*Math.random())+50,text:"額外小費"},{type:"bee",amount:1,text:"贈送一隻蜜蜂"},{type:"health",amount:10,text:"蜂巢健康度提升"}],o=e[Math.floor(Math.random()*e.length)];switch(o.type){case"money":t("ADD_MONEY",o.amount,{root:!0});break;case"bee":t("bees/ADD_BEES",o.amount,{root:!0});break;case"health":{const e=a.bees.hiveHealth+o.amount;t("bees/SET_HIVE_HEALTH",e,{root:!0});break}}s("showNotification",{message:`${i.customer}很滿意！${o.text}`,type:"success"},{root:!0})}}else s("showNotification",{message:"蜂蜜庫存不足，無法完成訂單！",type:"warning"},{root:!0})}}},ts={namespaced:!0,state:{activeMissions:[],selectedArea:null,maxMissions:3,areas:{garden:{name:"花園",description:"接近蜂巢的花園，安全但花蜜較少",distance:1,baseDuration:30,reward:{common:{min:1,max:3},wildflower:{min:0,max:1},mountain:{min:0,max:0},rare:{min:0,max:0}},risk:.05,beeCount:1},meadow:{name:"草地",description:"附近的開闊草地，有更多品種的野花",distance:2,baseDuration:60,reward:{common:{min:2,max:4},wildflower:{min:1,max:2},mountain:{min:0,max:.5},rare:{min:0,max:.1}},risk:.1,beeCount:2},forest:{name:"森林",description:"距離較遠的森林，有許多獨特的花種",distance:3,baseDuration:120,reward:{common:{min:1,max:2},wildflower:{min:2,max:4},mountain:{min:1,max:2},rare:{min:.1,max:.5}},risk:.15,beeCount:3},mountain:{name:"山區",description:"遙遠的山區，有稀有的高海拔花種",distance:5,baseDuration:180,reward:{common:{min:0,max:1},wildflower:{min:1,max:2},mountain:{min:2,max:4},rare:{min:.5,max:1}},risk:.25,beeCount:4}},honeyCollected:{common:0,wildflower:0,mountain:0,rare:0},missionStats:{totalMissions:0,successMissions:0,failedMissions:0},missionHistory:[]},getters:{canStartMission(e,t,s){const a=s.bees.bees;if(null===e.selectedArea)return!1;const o=e.areas[e.selectedArea],i=o.beeCount,n=e.activeMissions.reduce(((t,s)=>t+e.areas[s.area].beeCount),0);return a-n>=i&&e.activeMissions.length<e.maxMissions},foragingStats(e){return{totalMissions:e.activeMissions.length,maxMissions:e.maxMissions,totalHoneyCollected:Object.values(e.honeyCollected).reduce(((e,t)=>e+t),0)}}},mutations:{SET_SELECTED_AREA(e,t){e.selectedArea=t},START_MISSION(e,t){e.activeMissions.push(t)},COMPLETE_MISSION(e,t){const s=e.activeMissions.findIndex((e=>e.id===t));-1!==s&&e.activeMissions.splice(s,1)},ADD_COLLECTED_HONEY(e,{type:t,amount:s}){e.honeyCollected[t]+=s},SET_FORAGING_DATA(e,t){t.activeMissions&&(e.activeMissions=t.activeMissions),t.selectedArea&&(e.selectedArea=t.selectedArea),t.honeyCollected&&(e.honeyCollected=t.honeyCollected),t.maxMissions&&(e.maxMissions=t.maxMissions),t.missionHistory&&(console.log("設置任務歷史記錄:",t.missionHistory),e.missionHistory=t.missionHistory),t.missionStats&&(console.log("設置任務統計:",t.missionStats),e.missionStats=t.missionStats)},ADD_MISSION_RECORD(e,t){e.missionStats.totalMissions++,t.success?e.missionStats.successMissions++:e.missionStats.failedMissions++,e.missionHistory.unshift(t),e.missionHistory.length>10&&e.missionHistory.pop()}},actions:{selectArea({commit:e},t){e("SET_SELECTED_AREA",t)},startForagingMission({state:e,commit:t,rootState:s,rootGetters:a,dispatch:o},i){if(!a["foraging/canStartMission"])return void o("showNotification",{message:"無法開始採蜜任務！請確保有足夠的蜜蜂。",type:"warning"},{root:!0});const n=i.area,r=e.areas[n];let l=r.baseDuration;"medium"===i.duration?l*=2:"long"===i.duration&&(l*=4),console.log(`任務時間計算: 基礎=${r.baseDuration}, 選擇=${i.duration}, 計算後=${l}`);const c=s.weather.effectMultiplier||1,d=Math.ceil(l/c),m={id:Date.now(),area:n,bees:i.bees,risk:i.risk,duration:i.duration,durationSeconds:d,startTime:Date.now(),endTime:Date.now()+1e3*d,inProgress:!0};let h;if(t("START_MISSION",m),d<60)h=`${d} 秒`;else{const e=Math.floor(d/60),t=d%60;h=t>0?`${e} 分 ${t} 秒`:`${e} 分鐘`}o("showNotification",{message:`派出 ${i.bees} 隻蜜蜂去 ${r.name} 採蜜，預計需要 ${h}`,type:"info"},{root:!0}),setTimeout((()=>{o("completeMission",m.id)}),1e3*d)},completeMission({state:e,commit:t,dispatch:s},a){const o=e.activeMissions.findIndex((e=>e.id===a));if(-1===o)return;const i=e.activeMissions[o],n=e.areas[i.area],r=Math.random(),l=r>n.risk,c={id:i.id,area:i.area,date:Date.now(),bees:i.bees,risk:i.risk,success:l,rewards:{},lostBees:0};if(l){const a={};for(const[e,s]of Object.entries(n.reward)){if(s.max<=0)continue;const o=Math.random()*(s.max-s.min)+s.min;o>0&&(a[e]=Number(o.toFixed(1)),t("ADD_COLLECTED_HONEY",{type:e,amount:a[e]}),t("honey/ADD_HONEY_BY_TYPE",{type:e,amount:a[e]},{root:!0}))}c.rewards=a;let o=Object.entries(a).map((([t,s])=>`${s}kg ${e.honeyTypes?e.honeyTypes[t].name:t}`)).join("、");s("showNotification",{message:`採蜜成功！從 ${n.name} 收穫了 ${o}`,type:"success"},{root:!0})}else{const e=Math.random()<.3?1:0;c.lostBees=e,e>0&&t("bees/REMOVE_BEES",e,{root:!0}),s("showNotification",{message:`採蜜失敗！蜜蜂們在 ${n.name} 遇到了困難${e>0?`，損失了 ${e} 隻蜜蜂`:""}`,type:"danger"},{root:!0})}t("ADD_MISSION_RECORD",c),t("COMPLETE_MISSION",a)},upgradeForaging({state:e,commit:t,rootState:s,dispatch:a},o){const i=200;if(s.money<i)a("showNotification",{message:`金錢不足！升級採蜜需要 ${i} 元`,type:"warning"},{root:!0});else if(t("REMOVE_MONEY",i,{root:!0}),"capacity"===o)t("SET_FORAGING_DATA",{...e,maxMissions:e.maxMissions+1}),a("showNotification",{message:`採蜜能力提升！現在可以同時進行 ${e.maxMissions} 個任務`,type:"success"},{root:!0});else if("efficiency"===o){const s={...e.areas};for(const e in s){for(const t in s[e].reward)s[e].reward[t].min*=1.2,s[e].reward[t].max*=1.2;s[e].risk=Math.max(.01,.8*s[e].risk),s[e].baseDuration=Math.max(15,Math.floor(.9*s[e].baseDuration))}t("SET_FORAGING_DATA",{...e,areas:s}),a("showNotification",{message:"採蜜效率提升！獎勵增加，風險降低，時間縮短",type:"success"},{root:!0})}}}},ss={namespaced:!0,state:{currentChallenge:null,challengeHidden:!1,lastChallengeTime:null},getters:{hasChallengeActive(e){return null!==e.currentChallenge&&!e.challengeHidden}},mutations:{SET_CHALLENGE(e,t){e.currentChallenge=t,e.challengeHidden=!1},CLEAR_CHALLENGE(e){e.currentChallenge=null},HIDE_CHALLENGE(e){e.challengeHidden=!0},SET_LAST_CHALLENGE_TIME(e,t){e.lastChallengeTime=t}},actions:{maybeStartChallenge({state:e,commit:t,dispatch:s,rootState:a}){if(e.currentChallenge)return;const o=e.lastChallengeTime||0,i=Date.now();if(i-o<9e5)return;let n=.05;if(a.bees.bees>5){const e=Math.min(.15,(a.bees.bees-5)/5*.05);n+=e}if(Math.random()>n)return;t("SET_LAST_CHALLENGE_TIME",i);const r=["pest","environmental","weather"],l=r[Math.floor(Math.random()*r.length)];switch(l){case"pest":s("createPestChallenge");break;case"environmental":s("createEnvironmentalChallenge");break;case"weather":s("createWeatherChallenge",{weatherType:a.weather.current});break}},createPestChallenge({commit:e,dispatch:t}){const s={id:"mite",title:"蜂螨爆發",description:"蜂螨正在侵擾你的蜂群，可能導致蜜蜂生病或死亡！",severity:"high",solutions:[{name:"購買藥劑治療 (¥150)",cost:150,effectText:"蜂群已被治療，健康恢復中",action:"treatWithMedicine"},{name:"自然療法 (¥50，風險更高)",cost:50,effectText:"自然療法效果有限，蜂群仍有風險",action:"treatNaturally"}]};e("SET_CHALLENGE",{type:"pest",data:s}),t("showNotification",{message:`警告：${s.title}！`,type:"warning"},{root:!0})},createEnvironmentalChallenge({commit:e,dispatch:t}){const s=[{id:"pollution",title:"環境污染",description:"附近的工廠排放污染物，影響了蜜蜂的健康！",solutions:[{name:"安裝過濾裝置 (¥200)",cost:200,effectText:"過濾裝置有效阻擋了污染物",action:"installFilter"},{name:"遷移蜂巢 (¥100)",cost:100,effectText:"蜂巢遷移到了更安全的地方",action:"relocateHive"}]},{id:"pesticide",title:"農藥噴灑",description:"附近農田噴灑農藥，對蜜蜂造成傷害！",solutions:[{name:"與農民協商 (¥120)",cost:120,effectText:"成功說服農民使用有機方法",action:"negotiateWithFarmers"},{name:"加強蜂巢防護 (¥80)",cost:80,effectText:"簡單的防護措施，效果有限",action:"enhanceProtection"}]}],a=s[Math.floor(Math.random()*s.length)];e("SET_CHALLENGE",{type:"environmental",data:a}),t("showNotification",{message:`警告：${a.title}！`,type:"warning"},{root:!0})},createWeatherChallenge({commit:e,dispatch:t,rootState:s},{weatherType:a}){if(!a||s.weather.weatherTypes[a].effect>.7){const e=["rainy","drought","cold"];a=e[Math.floor(Math.random()*e.length)]}let o={id:a,title:s.weather.weatherTypes[a].name,description:`${s.weather.weatherTypes[a].description}，蜂蜜產量降低到${100*s.weather.weatherTypes[a].effect}%！`,solutions:[]};switch(a){case"rainy":o.solutions=[{name:"安裝雨棚 (¥100)",cost:100,effectText:"雨棚保護了蜂巢，產量恢復正常",action:"installShelter"},{name:"提供額外食物 (¥50)",cost:50,effectText:"蜜蜂不需要飛行就能獲得食物",action:"provideExtraFood"}];break;case"drought":o.solutions=[{name:"安裝灌溉系統 (¥150)",cost:150,effectText:"花朵得到水分，花蜜產量回升",action:"installIrrigation"},{name:"種植耐旱植物 (¥80)",cost:80,effectText:"新植物提供了穩定但有限的花蜜來源",action:"plantDroughtResistant"}];break;case"cold":o.solutions=[{name:"安裝保溫設備 (¥120)",cost:120,effectText:"蜂巢溫度升高，蜜蜂活動恢復正常",action:"installHeater"},{name:"提供高能量食物 (¥70)",cost:70,effectText:"蜜蜂獲得額外能量抵抗寒冷",action:"provideEnergyFood"}];break;default:o.solutions=[{name:"一般應對措施 (¥100)",cost:100,effectText:"基本措施，有助於緩解問題",action:"generalMeasures"}]}e("SET_CHALLENGE",{type:"weather",data:o}),t("showNotification",{message:`警告：${o.title}天氣挑戰！`,type:"warning"},{root:!0})},applySolution({state:e,commit:t,dispatch:s,rootState:a},o){if(!e.currentChallenge)return;if(a.money<o.cost)return void s("showNotification",{message:"金錢不足，無法應用此解決方案！",type:"warning"},{root:!0});t("REMOVE_MONEY",o.cost,{root:!0});const i=e.currentChallenge;switch(console.log(`Applying solution for challenge: ${i.type}`,o),o.action){case"treatWithMedicine":t("bees/SET_HIVE_HEALTH",a.bees.hiveHealth+20,{root:!0});break;case"treatNaturally":t("bees/SET_HIVE_HEALTH",a.bees.hiveHealth+5,{root:!0}),Math.random()<.3&&(s("showNotification",{message:"自然療法效果有限，一些蜜蜂受到影響！",type:"warning"},{root:!0}),t("bees/REMOVE_BEES",1,{root:!0}));break;case"installFilter":case"negotiateWithFarmers":t("bees/SET_HIVE_HEALTH",a.bees.hiveHealth+15,{root:!0}),t("bees/SET_HONEY_EFFICIENCY",1.1*a.bees.honeyPerBeePerMinute,{root:!0});break;case"relocateHive":case"enhanceProtection":t("bees/SET_HIVE_HEALTH",a.bees.hiveHealth+10,{root:!0});break;case"installShelter":case"installIrrigation":case"installHeater":s("weather/improveWeather",null,{root:!0});break;case"provideExtraFood":case"plantDroughtResistant":case"provideEnergyFood":case"generalMeasures":{const e=a.weather.current,s=a.weather.effectMultiplier;t("weather/SET_WEATHER",{current:e,effectMultiplier:Math.min(1,1.3*s),daysRemaining:1},{root:!0});break}}s("showNotification",{message:`已應用解決方案：${o.effectText}`,type:"success"},{root:!0}),t("CLEAR_CHALLENGE")},forceStartChallenge({dispatch:e}){const t=["pest","environmental","weather"],s=t[Math.floor(Math.random()*t.length)];switch(s){case"pest":e("createPestChallenge");break;case"environmental":e("createEnvironmentalChallenge");break;case"weather":e("createWeatherChallenge",{weatherType:null});break}},hideChallenge({commit:e}){e("HIDE_CHALLENGE")}}},as={namespaced:!0,state:{current:"sunny",effectMultiplier:1,daysRemaining:0,weatherTypes:{sunny:{name:"晴朗",description:"陽光明媚，蜜蜂活動頻繁",icon:"☀️",effect:1},cloudy:{name:"多雲",description:"天空多雲，蜜蜂活動略受影響",icon:"☁️",effect:.9},rainy:{name:"下雨",description:"雨水阻礙了蜜蜂採集花蜜",icon:"🌧️",effect:.6},windy:{name:"大風",description:"強風使蜜蜂難以飛行",icon:"🌬️",effect:.7},drought:{name:"乾旱",description:"乾旱使花朵缺乏花蜜",icon:"🏜️",effect:.5},cold:{name:"寒冷",description:"低溫使蜜蜂活動減緩",icon:"❄️",effect:.4},perfect:{name:"完美天氣",description:"理想的蜜蜂採集天氣，花朵盛開",icon:"🌈",effect:1.2}}},getters:{currentWeather(e){return{type:e.current,name:e.weatherTypes[e.current].name,description:e.weatherTypes[e.current].description,icon:e.weatherTypes[e.current].icon,effect:e.effectMultiplier}},isBadWeather(e){return e.effectMultiplier<.8},weatherEffectColor(e){return e.effectMultiplier>1?"#4caf50":e.effectMultiplier>.7?"#ff9800":"#e53935"}},mutations:{SET_WEATHER(e,{current:t,effectMultiplier:s,daysRemaining:a}){e.current=t,e.effectMultiplier=s,e.daysRemaining=a||0},DECREASE_WEATHER_DAYS(e){e.daysRemaining>0&&e.daysRemaining--},RESET_WEATHER(e){e.current="sunny",e.effectMultiplier=1,e.daysRemaining=0}},actions:{changeWeather({state:e,commit:t,dispatch:s}){if(e.daysRemaining>0)return void t("DECREASE_WEATHER_DAYS");const a={sunny:.3,cloudy:.25,rainy:.15,windy:.15,drought:.05,cold:.05,perfect:.05},o=Math.random();let i="sunny",n=0;for(const[l,c]of Object.entries(a))if(n+=c,o<n){i=l;break}const r=Math.floor(3*Math.random())+1;t("SET_WEATHER",{current:i,effectMultiplier:e.weatherTypes[i].effect,daysRemaining:r}),s("showNotification",{message:`天氣變化: ${e.weatherTypes[i].name} - ${e.weatherTypes[i].description}`,type:"info"},{root:!0}),e.weatherTypes[i].effect<.7&&Math.random()<.3&&s("challenges/createWeatherChallenge",{weatherType:i},{root:!0})},improveWeather({state:e,commit:t,dispatch:s}){"perfect"!==e.current?(t("SET_WEATHER",{current:"perfect",effectMultiplier:e.weatherTypes["perfect"].effect,daysRemaining:1}),s("showNotification",{message:"使用了天氣改善技術！現在是完美的採蜜天氣",type:"success"},{root:!0})):s("showNotification",{message:"天氣已經是最佳狀態！",type:"info"},{root:!0})}}},os={namespaced:!0,state:{currentTask:null,clicksCompleted:0,clicksNeeded:0,taskProgress:0,taskName:"",onComplete:null},getters:{isTaskActive(e){return null!==e.currentTask},taskProgressPercentage(e){return 0===e.clicksNeeded?0:e.clicksCompleted/e.clicksNeeded*100}},mutations:{SET_TASK(e,{taskName:t,clicksNeeded:s,onComplete:a}){e.currentTask=!0,e.clicksCompleted=0,e.clicksNeeded=s,e.taskProgress=0,e.taskName=t,e.onComplete=a},CLEAR_TASK(e){e.currentTask=null,e.clicksCompleted=0,e.clicksNeeded=0,e.taskProgress=0,e.taskName="",e.onComplete=null},PROGRESS_TASK(e){e.clicksCompleted++,e.taskProgress=e.clicksCompleted/e.clicksNeeded*100}},actions:{startLaborTask({state:e,commit:t},{taskName:s,clicksNeeded:a,onComplete:o}){null===e.currentTask&&t("SET_TASK",{taskName:s,clicksNeeded:a,onComplete:o})},progressTask({state:e,commit:t}){null!==e.currentTask&&(t("PROGRESS_TASK"),e.clicksCompleted>=e.clicksNeeded&&("function"===typeof e.onComplete&&e.onComplete(),t("CLEAR_TASK")))},cancelTask({state:e,commit:t,dispatch:s}){if(null===e.currentTask)return;const a=e.taskName;t("CLEAR_TASK"),s("showNotification",{message:`取消任務: ${a}`,type:"warning"},{root:!0})}}};const is=e=>{setInterval((()=>{e.dispatch("persistence/saveGame")}),1e3)};var ns={namespaced:!0,actions:{saveGame({rootState:e}){try{const t={money:e.money,bees:{bees:e.bees.bees,hiveLevel:e.bees.hiveLevel,hiveHealth:e.bees.hiveHealth,hiveCapacity:e.bees.hiveCapacity,honeyPerBeePerMinute:e.bees.honeyPerBeePerMinute,costs:e.bees.costs},honey:{total:e.honey.total,inventory:e.honey.inventory,capacity:e.honey.capacity},orders:{active:e.orders.active,completed:e.orders.completed,maxActive:e.orders.maxActive},foraging:{areas:e.foraging.areas,activeMissions:e.foraging.activeMissions,selectedArea:e.foraging.selectedArea,maxMissions:e.foraging.maxMissions,honeyCollected:e.foraging.honeyCollected,missionStats:e.foraging.missionStats,missionHistory:e.foraging.missionHistory},challenges:{currentChallenge:e.challenges.currentChallenge,lastChallengeTime:e.challenges.lastChallengeTime},laborTasks:{currentTask:e.laborTasks.currentTask,clicksCompleted:e.laborTasks.clicksCompleted,clicksNeeded:e.laborTasks.clicksNeeded,taskName:e.laborTasks.taskName},weather:e.weather,savedAt:Date.now()};localStorage.setItem("beekeeperGame",JSON.stringify(t)),console.log("遊戲已保存")}catch(t){console.error("保存遊戲時出錯:",t)}},loadGame({commit:e}){const t=localStorage.getItem("beekeeperGame");if(t)try{const s=JSON.parse(t);if(void 0!==s.money&&e("SET_MONEY",s.money,{root:!0}),s.bees){const t=s.bees;void 0!==t.bees&&e("bees/SET_BEES",t.bees,{root:!0}),void 0!==t.hiveLevel&&e("bees/SET_HIVE_LEVEL",t.hiveLevel,{root:!0}),void 0!==t.hiveHealth&&e("bees/SET_HIVE_HEALTH",t.hiveHealth,{root:!0}),void 0!==t.hiveCapacity&&e("bees/SET_HIVE_CAPACITY",t.hiveCapacity,{root:!0}),void 0!==t.honeyPerBeePerMinute&&e("bees/SET_HONEY_EFFICIENCY",t.honeyPerBeePerMinute,{root:!0}),t.costs&&e("bees/SET_COSTS",t.costs,{root:!0})}if(s.honey){const t=s.honey;if("object"===typeof t&&t.inventory){e("honey/SET_HONEY_CAPACITY",t.capacity||100,{root:!0}),e("honey/SET_HONEY",0,{root:!0});for(const s in t.inventory)t.inventory[s]>0&&e("honey/ADD_HONEY_BY_TYPE",{type:s,amount:t.inventory[s]},{root:!0})}else e("honey/SET_HONEY",t,{root:!0})}if(s.orders&&e("orders/SET_ORDERS",s.orders,{root:!0}),s.foraging){const t={activeMissions:s.foraging.activeMissions||[],selectedArea:s.foraging.selectedArea||null,honeyCollected:s.foraging.honeyCollected||{common:0,wildflower:0,mountain:0,rare:0},maxMissions:s.foraging.maxMissions||3,missionHistory:s.foraging.missionHistory||[],missionStats:s.foraging.missionStats||{totalMissions:0,successMissions:0,failedMissions:0}};e("foraging/SET_FORAGING_DATA",t,{root:!0})}s.challenges&&(s.challenges.currentChallenge&&e("challenges/SET_CHALLENGE",s.challenges.currentChallenge,{root:!0}),s.challenges.lastChallengeTime&&e("challenges/SET_LAST_CHALLENGE_TIME",s.challenges.lastChallengeTime,{root:!0})),s.weather&&e("weather/SET_WEATHER",s.weather,{root:!0}),console.log("遊戲數據已從本地存儲加載")}catch(s){console.error("加載遊戲數據時出錯:",s),e("bees/ADD_BEES",3,{root:!0})}else e("bees/SET_BEES",3,{root:!0})}}},rs=(0,Q.y$)({state:{currentBeeFact:"蜜蜂是地球上最重要的授粉者之一，對全球農業生產和生態系統至關重要。",money:100},mutations:{SET_BEE_FACT(e,t){e.currentBeeFact=t},SET_MONEY(e,t){e.money=t},ADD_MONEY(e,t){e.money+=t},REMOVE_MONEY(e,t){e.money=Math.max(0,e.money-t)}},actions:{showNotification(e,{message:t,type:s="info"}){const a=document.querySelector(".notification-area");if(!a)return void console.error("無法找到通知區域元素");const o=document.createElement("div");o.className=`notification ${s}`,o.textContent=t,a.appendChild(o),setTimeout((()=>{o.style.animation="slideOut 0.3s forwards",setTimeout((()=>{o.remove()}),300)}),3e3)},initGame({commit:e,dispatch:t}){console.log("初始化遊戲..."),t("loadGame"),setInterval((()=>{t("honey/produceHoney"),Date.now()%6e4<1e3&&t("saveGame"),Date.now()%3e5<1e3&&t("challenges/maybeStartChallenge")}),1e3),t("orders/initOrders");const s=["一隻工蜂一生中只能生產約1茶匙的蜂蜜。","蜂后一天可以產下多達2000顆蛋，是自己體重兩倍的蛋量。","蜜蜂會跳舞來告訴其他蜜蜂花蜜的位置。","蜜蜂翅膀每秒鐘可以拍打200次。","一個健康的蜂巢在夏季可以有高達80,000隻蜜蜂。"];e("SET_BEE_FACT",s[Math.floor(Math.random()*s.length)]),setInterval((()=>{e("SET_BEE_FACT",s[Math.floor(Math.random()*s.length)])}),6e4)},saveGame({dispatch:e}){e("persistence/saveGame")},loadGame({dispatch:e}){e("persistence/loadGame")}},modules:{bees:zt,honey:Zt,orders:es,foraging:ts,challenges:ss,weather:as,laborTasks:os,persistence:ns},plugins:[is]});(0,a.Ef)(c).use(rs).use(Jt).mount("#app")}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,a,o,i){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],i=e[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&i||n>=i)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(r=!1,i<n&&(n=i));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,o,i]}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p="/beekeeper/"}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,n=a[0],r=a[1],l=a[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var d=l(s)}for(t&&t(a);c<n.length;c++)i=n[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},a=self["webpackChunkbeekeeper"]=self["webpackChunkbeekeeper"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(9308)}));a=s.O(a)})();
//# sourceMappingURL=app.fff51f33.js.map